function ExtendTree(n,t){if($(n).children("ul").remove(),t!=""){var r=$.parseJSON(t),i=$('<ul class="fm-subtree"><\/ul>');$(n).append(i);$.each(r,function(n,t){$(i).append('<li class="fm-dirnode" data-value="'+t.Address+'"><div class="fm-toggle-subtree fm-icon-minifolder pull-left"><\/div><label class="fm-dirname">'+t.Title+"<\/label><\/li>")})}}function ShowFiles(n,t){if((t==undefined||t)&&$(".fm-files").children().remove(),n!=""){var i=$.parseJSON(n);$.each(i,function(n,t){$(".fm-files").append('<li class="fm-filenode ui-widget-content" data-value="'+t.Address+'" data-size="'+t.FileSize+'" data-date="'+t.DateCreated+'" data-ext="'+t.Extension+'"><img src="/Content/filemanager/'+t.Extension+'.png" alt="alternative image" onerror="this.src=\'/Content/filemanager/UNKNOWN.png\'" width="56" /><p class="fm-filename">'+t.Title+"<\/p><\/li>")})}}function clearAttributes(){$("[class^=fm-attr-]").text("")}function maskLoad(n){var i=$(n).offset(),t=$('<div class="fm-mask" data-elem="'+n+'"><\/div>');t.offset({top:i.top,left:i.left});t.width($(n).width());t.height($(n).height());$(document.body).prepend(t)}function unmask(n){$('[data-elem="'+n+'"]').remove()}function loadData(n){var t;$.ajax({url:handlerURL,data:"opName=getDirs&dir=/"+n.attr("data-value"),success:function(i){t=i;ExtendTree(n,i);$(".fm-tree-selected").removeClass("fm-tree-selected");$(n).toggleClass("fm-tree-selected")},complete:function(){$.ajax({url:handlerURL,data:"opName=getFiles&dir=/"+n.attr("data-value"),success:function(n){ShowFiles(t);ShowFiles(n,!1)},complete:function(){unmask(".fm-right")}})}});paste="/"+n.attr("data-value");$("[name=dir]").val("/"+n.attr("data-value"))}function getFileSize(n){return n<1024?n+"B":n<131072?(n/1024).toFixed(2)+"KB":(n/131072).toFixed(2)+"MB"}function ShowFileAttrib(){var n=$(".fm-files").find("li.ui-selected"),t;$(".fm-attr-address").text($(n).attr("data-value"));$(".fm-attr-size").text(getFileSize($(n).attr("data-size")));t=new Date($(n).attr("data-date"));$(".fm-attr-creationDate").text(t.toLocaleDateString()+" "+t.toLocaleTimeString());$(n).attr("data-ext").toLowerCase()=="folder"&&(paste=$(n).attr("data-value"))}function ShowFilesAttrib(){var t=$(".fm-files").find("li.ui-selected"),n;$(".fm-attr-address").text("");n=0;$(".fm-files>li.ui-selected").each(function(t,i){n+=parseInt($(i).attr("data-size"))});$(".fm-attr-size").text(getFileSize(n));$(".fm-attr-creationDate").text("-");$(t).attr("data-ext").toLowerCase()=="folder"&&(paste=$(t).attr("data-value"))}function Reload(){maskLoad(".fm-right");loadData($(".fm-tree-selected"))}function getUrlParam(n){var i=new RegExp("(?:[?&]|&)"+n+"=([^&]+)","i"),t=window.location.search.match(i);return t&&t.length>1?t[1]:null}function renameFile(n){var t=$(n).val();$(n).hide();$.ajax({url:handlerURL,data:"opName=rename&dir=/"+$(n).parent(".fm-filenode").attr("data-value")+"&name="+t,success:function(t){var i=$.parseJSON(t)[0];$(n).prev("p").text(i.Title).show().parent(".fm-filenode").attr("data-value",i.Address).attr("data-ext",i.Extension).attr("data-date",i.CreatedDate);$(n).remove()}})}function copy(n){$(".fm-copy").removeClass("fm-copy");$(".fm-cut").removeClass("fm-cut");$(n).addClass("fm-copy");cuts={};copies=$(n)}function cut(n){$(".fm-copy").removeClass("fm-copy");$(".fm-cut").removeClass("fm-cut");$(n).addClass("fm-cut");copies={};cuts=$(n)}var copies={},cuts={},paste={};handlerURL="/FilemanagerHandler.ashx";$(document).ready(function(){loadData($(".fm-tree-directory li:first"));$(".fm-tree-directory").on("click",".fm-dirname",function(){clearAttributes();var n=$(this).parent("li");n.attr("data-value")!=undefined&&(maskLoad(".fm-right"),loadData(n))});$(".fm-tree-directory").on("click",".fm-toggle-subtree",function(){clearAttributes();$(this).parent("li").children(".fm-subtree").length===0?$(this).next(".fm-dirname").click():$(this).parent("li").children(".fm-subtree").slideToggle()});$(".fm-files").selectable({cancel:".ui-selected"});$("[data-translate-title]").each(function(n,t){$(t).attr("title",Lang[$(t).attr("data-translate-title")])});$("[data-translate-text]").each(function(n,t){$(t).text(Lang[$(t).attr("data-translate-text")])});$("[data-translate-value]").each(function(n,t){$(t).val(Lang[$(t).attr("data-translate-value")])});$("button").tooltip();$(".fm-btngroup-open>button").prop("disabled",!0);$(".fm-btngroup-edit>button").prop("disabled",!0);$("#fm-btn-rename").prop("disabled",!0);$("#fm-btn-delete").prop("disabled",!0)});$(".fm-files").on("selectablestop",function(){var n=$(".fm-files").find("li.ui-selected").length;n==0?($(".fm-btngroup-open>button").prop("disabled",!0),$(".fm-btngroup-edit>button").prop("disabled",!0),$("#fm-btn-rename").prop("disabled",!0),$("#fm-btn-delete").prop("disabled",!0),$("#fm-btn-paste").prop("disabled",copies.length==0&&cuts.length==0),clearAttributes()):n==1?($(".fm-btngroup-open>button").prop("disabled",!1),$(".fm-btngroup-edit>button").prop("disabled",!1),$("#fm-btn-rename").prop("disabled",!1),$("#fm-btn-delete").prop("disabled",!1),$("#fm-btn-paste").prop("disabled",copies.length==0&&cuts.length==0),ShowFileAttrib()):n>1&&($(".fm-btngroup-open>button").prop("disabled",!0),$(".fm-btngroup-edit>button").prop("disabled",!0),$("#fm-btn-rename").prop("disabled",!0),$("#fm-btn-delete").prop("disabled",!1),$("#fm-btn-paste").prop("disabled",copies.length==0&&cuts.length==0),ShowFilesAttrib())});$(".fm-files").on("dblclick",".fm-filenode",function(){if($(this).attr("data-ext")=="folder")$('.fm-dirnode[data-value="'+$(this).attr("data-value")+'"]>.fm-toggle-subtree').click();else{var n=getUrlParam("CKEditorFuncNum");window.opener.CKEDITOR.tools.callFunction(n,"/"+$(this).attr("data-value"));window.close()}});$("#fm-btn-upload").click(function(){$("#uploadModal").modal("show")});$("#fm-btn-newfolder").click(function(){$("#newFolderModal").modal("show")});$("#fm-btn-newfile").click(function(){$("#newFileModal").modal("show")});$("#fm-btn-openFile").click(function(){window.open("/"+$(".fm-files").find("li.ui-selected").attr("data-value"))});$("#fm-btn-download").click(function(){window.open(handlerURL+"?opName=dlFile&dir="+$(".fm-files").find("li.ui-selected").attr("data-value"))});$("#fm-btn-copy").click(function(){copy($(".fm-files").find("li.ui-selected"))});$("#fm-btn-cut").click(function(){cut($(".fm-files").find("li.ui-selected"))});$("#fm-btn-paste").click(function(){copies.length>0?(copies.each(function(){$.ajax({url:handlerURL,data:"opName=copy&dir1=/"+paste+"&dir2=/"+$(this).attr("data-value")})}),maskLoad(".fm-right"),loadData($(".fm-tree-selected"))):cuts.length>0&&(cuts.each(function(){$.ajax({url:handlerURL,data:"opName=cut&dir1=/"+paste+"&dir2=/"+$(this).attr("data-value")})}),maskLoad(".fm-right"),loadData($(".fm-tree-selected")))});$("#btnSearch").click(function(){$(".fm-files>li").hide();$('.fm-files>li>p:contains("'+$("#txtSearch").val()+'")').parent("li").show()});$("#fm-btn-delete").click(function(){$(".fm-files").find("li.ui-selected").each(function(n,t){$.ajax({url:handlerURL,data:"opName=delete&dir=/"+$(t).attr("data-value"),complete:function(){maskLoad(".fm-right");loadData($(".fm-tree-selected"))}})});maskLoad(".fm-right");loadData($(".fm-tree-selected"))});$("#fm-btn-rename").click(function(){var n=$(".fm-files").find("li.ui-selected").append('<textarea class="fm-txt-rename form-control" type="text" >'+$(".fm-files>li.ui-selected>.fm-filename").text()+"<\/textarea>");$(".fm-files>li.ui-selected>.fm-filename").hide();$(".fm-files>li.ui-selected>textarea").focus();$(".fm-files>li.ui-selected>textarea").select();$(".fm-txt-rename").blur(function(){renameFile(this)});$(".fm-txt-rename").keypress(function(n){n.which==13&&renameFile(this)})});$("#fm-btn-duplicate").click(function(){$.ajax({url:handlerURL,data:"opName=copy&dir1=/"+$(".fm-tree-selected").attr("data-value")+"&dir2=/"+$(".fm-files").find("li.ui-selected").attr("data-value"),complete:function(){maskLoad(".fm-right");loadData($(".fm-tree-selected"))}})});$('form[name="uploadFrm"]').submit(function(n){var t,i,r;window.FormData!==undefined&&(n.preventDefault(),t=new FormData,$.each($(this).find('input[name="fileUpload"]')[0].files,function(n,i){t.append(n,i)}),t.append("dir",$(this).find('input[name="dir"]').val()),$(this).find(".progress").removeClass("hide"),i=$(this),r=$(this).find(".progress-bar"),$(r).attr("aria-valuenow",0).text("0%").css("width","0%"),$.ajax({url:handlerURL+"?opName=uplaodFile",type:"POST",data:t,cache:!1,dataType:"json",processData:!1,contentType:!1,xhrFields:{onprogress:function(n){if(n.lengthComputable){var t=n.loaded/n.total*100;$(r).attr("aria-valuenow",t).text(t+"%").css("width",t+"%")}else console.log("Length not computable.")}},success:function(){Reload()},error:function(n,t){console.log("ERRORS: "+t)},complete:function(){$(i).trigger("reset");$(i).find(".progress").addClass("hide");$("#uploadModal").modal("hide")}}))});$('form[name="newFolderFrm"]').submit(function(n){n.preventDefault();var t=this;$.ajax({url:handlerURL,type:"POST",data:$(t).serialize(),success:function(){Reload()},error:function(n,t){console.log("ERRORS: "+t)},complete:function(){$(t).trigger("reset");$("#newFolderModal").modal("hide")}})});$('form[name="newFileFrm"]').submit(function(n){n.preventDefault();var t=this;$.ajax({url:handlerURL,type:"POST",data:$(t).serialize(),success:function(){Reload()},error:function(n,t){console.log("ERRORS: "+t)},complete:function(){$(t).trigger("reset");$("#newFileModal").modal("hide")}})});
/*
//# sourceMappingURL=Filemanager.min.js.map
*/